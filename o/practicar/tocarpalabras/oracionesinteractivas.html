<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catequesis Offline - Ordenar Oraciones</title>
    
    <style>
        /* Estilos Generales */
        :root {
            --color-fondo: #f0f2f5;
            --color-primario: #3b5998;
            --color-correcto: #4caf50;
            --color-incorrecto: #f44336;
        }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            background-color: var(--color-fondo);
            margin: 0;
            padding: 10px;
            box-sizing: border-box;
        }
        .container { 
            width: 100%; 
            max-width: 600px; 
            text-align: center; 
        }

        /* Menú */
        #menu-oraciones .oracion-btn {
            display: block; width: 100%; padding: 15px; margin: 10px 0;
            font-size: 1.2em; cursor: pointer; border: 1px solid #ccc;
            border-radius: 8px; background-color: white; transition: background-color 0.3s;
        }
        #menu-oraciones .oracion-btn:hover { background-color: #e9ebee; }

        /* Área de Práctica */
        #area-practica { display: none; }
        #oracion-progreso { font-size: 1.1em; color: var(--color-primario); margin-bottom: 15px; }

        /* Contenedores para las fichas */
        #fichas-desordenadas, #area-respuesta {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            margin: 15px 0;
            min-height: 60px;
            border-radius: 8px;
        }
        #fichas-desordenadas { background-color: #e9ebee; }
        #area-respuesta { border: 2px dashed #ccc; background-color: white; }

        /* Ficha (palabra) */
        .ficha {
            padding: 10px 15px;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 1.2em;
            cursor: pointer; /* Cambiado de 'grab' a 'pointer' */
            user-select: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .ficha:hover {
             transform: scale(1.05);
        }

        .ficha.correcta { background-color: var(--color-correcto); color: white; }
        .ficha.incorrecta { background-color: var(--color-incorrecto); color: white; }

        /* Controles */
        #controls button {
            padding: 12px 22px; font-size: 1em; cursor: pointer; margin: 5px;
            border-radius: 8px; border: none; color: white;
        }
        #check-btn { background-color: var(--color-primario); }
        #back-btn { background-color: #6c757d; }
    </style>
</head>
<body>

    <div class="container">
        <div id="menu-oraciones">
            <h2>Elige una oración para practicar</h2>
        </div>

        <div id="area-practica">
            <h2 id="prayer-title"></h2>
            <p id="oracion-progreso"></p>
            <p><strong>Toca las palabras para ordenarlas:</strong></p>
            
            <div id="area-respuesta"></div>
            <div id="fichas-desordenadas"></div>

            <div id="controls">
                <button id="check-btn">Revisar</button>
                <button id="back-btn">← Volver al Menú</button>
                <p id="status"></p>
            </div>
        </div>
    </div>

    <script>
        // --- ELEMENTOS DEL DOM ---
        const menuOracionesDiv = document.getElementById('menu-oraciones');
        const areaPracticaDiv = document.getElementById('area-practica');
        const prayerTitleH2 = document.getElementById('prayer-title');
        const progresoP = document.getElementById('oracion-progreso');
        const fichasContainer = document.getElementById('fichas-desordenadas');
        const respuestaContainer = document.getElementById('area-respuesta');
        const checkBtn = document.getElementById('check-btn');
        const backBtn = document.getElementById('back-btn');
        const statusP = document.getElementById('status');

        // --- DATOS DE LAS ORACIONES ---
        const oraciones = [
            {
                titulo: "Padre Nuestro",
                frases: [
                    "Padre nuestro que estás en el cielo",
                    "santificado sea tu Nombre",
                    "venga a nosotros tu Reino",
                    "hágase tu voluntad en la tierra como en el cielo",
                    "Danos hoy nuestro pan de cada día",
                    "perdona nuestras ofensas como también nosotros perdonamos a los que nos ofenden",
                    "no nos dejes caer en la tentación y líbranos del mal Amén"
                ]
            },
            {
                titulo: "Ave María",
                frases: [
                    "Dios te salve María llena eres de gracia",
                    "el Señor es contigo",
                    "bendita tú eres entre todas las mujeres",
                    "y bendito es el fruto de tu vientre Jesús",
                    "Santa María Madre de Dios ruega por nosotros pecadores",
                    "ahora y en la hora de nuestra muerte Amén"
                ]
            }
        ];

        let oracionActual;
        let fraseActualIndex;

        // --- FUNCIONES PRINCIPALES ---

        function crearMenu() {
            oraciones.forEach((oracion, index) => {
                const boton = document.createElement('button');
                boton.textContent = oracion.titulo;
                boton.className = 'oracion-btn';
                boton.addEventListener('click', () => prepararPractica(index));
                menuOracionesDiv.appendChild(boton);
            });
        }

        function prepararPractica(index) {
            oracionActual = oraciones[index];
            fraseActualIndex = 0;
            
            prayerTitleH2.textContent = oracionActual.titulo;
            menuOracionesDiv.style.display = 'none';
            areaPracticaDiv.style.display = 'block';
            
            cargarSiguienteFrase();
        }

        function cargarSiguienteFrase() {
            fichasContainer.innerHTML = '';
            respuestaContainer.innerHTML = '';
            statusP.textContent = '';
            checkBtn.disabled = false;
            
            if (fraseActualIndex >= oracionActual.frases.length) {
                statusP.textContent = `¡Felicidades! Has completado la oración de ${oracionActual.titulo}.`;
                checkBtn.disabled = true;
                return;
            }

            progresoP.textContent = `Frase ${fraseActualIndex + 1} de ${oracionActual.frases.length}`;
            const frase = oracionActual.frases[fraseActualIndex];
            const palabras = frase.split(' ');

            barajarArray(palabras).forEach(palabra => {
                const ficha = document.createElement('div');
                ficha.textContent = palabra;
                ficha.className = 'ficha';
                ficha.addEventListener('click', moverFicha); // NUEVA LÓGICA DE CLIC
                fichasContainer.appendChild(ficha);
            });
        }

        function barajarArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- NUEVA LÓGICA DE CLIC PARA MOVER FICHAS ---
        function moverFicha(event) {
            const fichaSeleccionada = event.target;
            
            // Si la ficha está en el contenedor de abajo, muévela para arriba
            if (fichaSeleccionada.parentNode === fichasContainer) {
                respuestaContainer.appendChild(fichaSeleccionada);
            } 
            // Si no, muévela para abajo (para corregir)
            else {
                fichasContainer.appendChild(fichaSeleccionada);
            }
        }

        // --- FUNCIÓN DE REVISAR CORREGIDA ---
        function revisarRespuesta() {
            // CORRECCIÓN: Se usaba "frraseActualIndex", ahora es "fraseActualIndex"
            const fraseCorrecta = oracionActual.frases[fraseActualIndex]; 
            const fichasRespuesta = respuestaContainer.querySelectorAll('.ficha');
            
            let respuestaUsuarioArray = [];
            fichasRespuesta.forEach(ficha => respuestaUsuarioArray.push(ficha.textContent));
            const respuestaUsuarioStr = respuestaUsuarioArray.join(' ');

            if (respuestaUsuarioStr === fraseCorrecta) {
                statusP.textContent = '¡Correcto! Siguiente frase...';
                fichasRespuesta.forEach(ficha => {
                    ficha.classList.add('correcta');
                    ficha.removeEventListener('click', moverFicha); // Desactivar clic en fichas correctas
                });
                fraseActualIndex++;
                setTimeout(cargarSiguienteFrase, 1500); // Esperar para cargar la siguiente
            } else {
                statusP.textContent = 'Casi, inténtalo de nuevo.';
                fichasRespuesta.forEach(ficha => ficha.classList.add('incorrecta'));
                setTimeout(() => {
                    fichasRespuesta.forEach(ficha => ficha.classList.remove('incorrecta'));
                }, 1500);
            }
        }
        
        function volverAlMenu() {
            areaPracticaDiv.style.display = 'none';
            menuOracionesDiv.style.display = 'block';
        }

        // --- INICIALIZACIÓN ---
        window.onload = crearMenu;
        checkBtn.addEventListener('click', revisarRespuesta);
        backBtn.addEventListener('click', volverAlMenu);

    </script>
</body>
</html>